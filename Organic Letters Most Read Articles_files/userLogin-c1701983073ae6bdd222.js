(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{141:function(e,a,t){var r=t(17);e.exports=function _defineProperty(e,a,t){return(a=r(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e},e.exports.__esModule=!0,e.exports.default=e.exports},262:function(e,a,t){var r,o=t(141);function ownKeys(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function _objectSpread(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?ownKeys(Object(t),!0).forEach((function(a){o(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}r={$loginLink:$("a.user-login-bar__Login"),$logoutLink:$("a.user-login-bar__Logout"),statusEndpoint:$(".statusEndpoint").val(),clientID:$(".clientID").val(),logoutUrl:$(".logoutUrl").val(),heartBeatReloadInterval:$(".heartBeatReloadInterval").val(),$heartBeatImage:$(".ssoHeartBeatImg"),$userName:$(".user-login-bar__name"),$logInBarMsgContainer:$("span.user-login-bar__value"),statusServiceCall:$(".statusServiceCall").val(),query_string_json:"?padding=jsonPaddingFunction&appid="+$(".clientID").val(),query_string_core:"?appid="+$(".clientID").val(),$params:{},init:function init(){r.control(),r.showDevicePairingSuccessModal(),r.heartBeatImageReload(),r.constructParams(),r.checkIfSsoUserIsAlreadyLoggedIn(r.userLoginCallback)},control:function control(){0!==r.$loginLink.length&&r.$loginLink.on("click",(function(){r.saveCurrentUrlCookie()})),0!==r.$logoutLink.length&&r.$logoutLink.on("click",(function(){r.removeDevicePairingAppearedBeforeCookie()}))},userLoginCallback:function userLoginCallback(e,a){e&&0!==r.$loginLink.length&&(a&&r.updateLoginView(a),$("<iframe />",{src:"/action/ssoRequestForLoginPage",name:"sso-handshake",id:"sso-handshake",style:"width:0px;height:0px",load:function load(e){console.log("Login requested.")}}).appendTo("body"))},removeDevicePairingAppearedBeforeCookie:function removeDevicePairingAppearedBeforeCookie(){$.removeCookie("devicePairingModalAppearedBefore",!0,{path:"/"})},saveCurrentUrlCookie:function saveCurrentUrlCookie(){$.cookie("SSO_URL_BEFORE_LOGIN",window.location.href,{path:"/"})},updateLoginView:function updateLoginView(e){var a;$(".user-login-bar").length&&(a="<span class='welcomeMsg'>Welcome: </span><a href='/action/showPreferences?menuTab=AccountInfo' class='user-login-bar__name'>"+e+"</a><span class='user-login-bar__separator'>|</span><a href="+r.logoutUrl+" class='user-login-bar__Logout'>Logout</a>",r.$logInBarMsgContainer.html(a))},showDevicePairingSuccessModal:function showDevicePairingSuccessModal(){var e="devicePairingModalAppearedBefore",a=$(".pair-device-success-modal-btn");0!==$(".pair-device-is-paired").length&&"true"===$(".pair-device-is-paired").val()&&"true"!==$.cookie(e)&&(a.length>=0&&$(a[0]).trigger("click"),$.cookie(e,!0,{path:"/"}),setTimeout((function(){var e=$(".pair-device-success-modal .close");e.length>0&&$(e[0]).trigger("click")}),3e3))},constructParams:function constructParams(){switch(r.statusServiceCall){case"JSONP":r.$params.url=r.statusEndpoint+r.query_string_json,r.$params.jsonpCallback="jsonPaddingFunction",r.$params.dataType="jsonp";break;case"CORS":r.$params.url=r.statusEndpoint+r.query_string_core}},checkIfSsoUserIsAlreadyLoggedIn:function checkIfSsoUserIsAlreadyLoggedIn(e){$.ajax(_objectSpread(_objectSpread({type:"get",contentType:"application/json",cache:!1,xhrFields:{withCredentials:!0}},r.$params),{},{success:function success(a){var t,r;a.succ&&a.results?(t=a.results.loggedin,r=a.results.firstname,t?(console.log("Logged in using SSO!"),e(!0,r)):(console.log("Not logged using SSO!"),e(!1,r))):(console.log("Not logged using SSO! (No success in response)"),e(!1))},error:function error(a){e(!1),console.log("[[UX.userLogin.checkIfSsoUserIsAlreadyLoggedIn]], Error: "+a)}}))},heartBeatImageReload:function heartBeatImageReload(){r.heartBeatReloadInterval&&$.cookie("AUTO_SINGIN_SSO")&&(setInterval((function(){r.setSSOHeartBeatImage()}),r.heartBeatReloadInterval),setInterval((function(){r.setLiteratumHeartBeatIframe()}),r.heartBeatReloadInterval))},setSSOHeartBeatImage:function setSSOHeartBeatImage(e){if(0!==r.$heartBeatImage.length){var a=Math.floor(1e7*Math.random()),t=r.$heartBeatImage.attr("src");t=r.removeParam("random",t),r.$heartBeatImage.get(0).onload=function(){e&&e()},r.$heartBeatImage.attr("src",t+"&random="+a)}},setLiteratumHeartBeatIframe:function setLiteratumHeartBeatIframe(){var e=$("iframe[name='literatum-session-heart-beat']");e.length>0&&e.remove(),$("<iframe />",{src:"/action/heartBeatSessionRevival",name:"literatum-session-heart-beat",id:"literatum-session-heart-beat",style:"width:0px; height:0px; display:none"}).appendTo("body")},removeParam:function removeParam(e,a){var t,r=a.split("?")[0],o=[],n=-1!==a.indexOf("?")?a.split("?")[1]:"";if(""!==n){for(t=(o=n.split("&")).length-1;t>=0;t-=1)o[t].split("=")[0]===e&&o.splice(t,1);r=r+"?"+o.join("&")}return r},getUserName:function getUserName(){return r.$userName?r.$userName.html():""}},UX.userLogin=r}}]);
//# sourceMappingURL=userLogin-c1701983073ae6bdd222.js.map